# Swigger2API æµ‹è¯•å¥—ä»¶

è¿™ä¸ªæµ‹è¯•å¥—ä»¶æä¾›äº†å®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼Œè®©ä½ åœ¨ä¿®æ”¹ä»£ç åèƒ½å¤Ÿå¿«é€ŸéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
test/
â”œâ”€â”€ README.md              # æœ¬æ–‡æ¡£
â”œâ”€â”€ run-tests.js           # å®Œæ•´æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ quick-test.js          # å¿«é€Ÿæµ‹è¯•è„šæœ¬
â”œâ”€â”€ cleanup.js             # æ¸…ç†è„šæœ¬
â”œâ”€â”€ configs/               # æµ‹è¯•é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ test.config.ts     # TypeScript é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ test.config.js     # JavaScript é¡¹ç›®é…ç½®
â”‚   â””â”€â”€ custom.config.js   # è‡ªå®šä¹‰é…ç½®ç¤ºä¾‹
â”œâ”€â”€ fixtures/              # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ sample-swagger.json # ç¤ºä¾‹ Swagger æ–‡æ¡£
â””â”€â”€ output/                # æµ‹è¯•è¾“å‡ºç›®å½•
    â”œâ”€â”€ ts-api/            # TypeScript ç”Ÿæˆç»“æœ
    â”œâ”€â”€ js-api/            # JavaScript ç”Ÿæˆç»“æœ
    â””â”€â”€ custom-api/        # è‡ªå®šä¹‰é…ç½®ç”Ÿæˆç»“æœ
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èï¼‰

åœ¨ä¿®æ”¹ä»£ç åï¼Œè¿è¡Œå¿«é€Ÿæµ‹è¯•æ¥éªŒè¯åŸºæœ¬åŠŸèƒ½ï¼š

```bash
# è¿è¡Œå¿«é€Ÿæµ‹è¯•
node test/quick-test.js

# æˆ–è€…ä½¿ç”¨ npm scriptï¼ˆå¦‚æœå·²é…ç½®ï¼‰
npm run test:quick
```

### 2. å®Œæ•´æµ‹è¯•

è¿è¡Œæ‰€æœ‰æµ‹è¯•é…ç½®ï¼Œå…¨é¢éªŒè¯åŠŸèƒ½ï¼š

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
node test/run-tests.js

# æˆ–è€…ä½¿ç”¨ npm scriptï¼ˆå¦‚æœå·²é…ç½®ï¼‰
npm run test:full
```

### 3. æ¸…ç†æµ‹è¯•æ–‡ä»¶

æ¸…ç†ä¹‹å‰çš„æµ‹è¯•è¾“å‡ºï¼š

```bash
# æ¸…ç†æµ‹è¯•æ–‡ä»¶
node test/cleanup.js

# æˆ–è€…ä½¿ç”¨ npm scriptï¼ˆå¦‚æœå·²é…ç½®ï¼‰
npm run test:clean
```

## ğŸ“‹ æµ‹è¯•é…ç½®è¯´æ˜

### TypeScript é…ç½® (`test.config.ts`)

- **ç›®æ ‡è¯­è¨€**: TypeScript
- **è¾“å‡ºç›®å½•**: `./test/output/ts-api`
- **ç”Ÿæˆç±»å‹**: æ˜¯
- **æ¨¡å—å‘½å**: åŸºäº tags
- **API å‘½å**: åŸºäº operationId

### JavaScript é…ç½® (`test.config.js`)

- **ç›®æ ‡è¯­è¨€**: JavaScript
- **è¾“å‡ºç›®å½•**: `./test/output/js-api`
- **ç”Ÿæˆç±»å‹**: å¦
- **æ¨¡å—å‘½å**: åŸºäº tags
- **API å‘½å**: åŸºäº operationId

### è‡ªå®šä¹‰é…ç½® (`custom.config.js`)

- **ç›®æ ‡è¯­è¨€**: TypeScript
- **è¾“å‡ºç›®å½•**: `./test/output/custom-api`
- **æ¨¡å—å‘½å**: è‡ªå®šä¹‰å‡½æ•°ï¼ˆè·¯å¾„å‰ç¼€ + é¦–å­—æ¯å¤§å†™ï¼‰
- **API å‘½å**: è‡ªå®šä¹‰å‡½æ•°

## ğŸ§ª æµ‹è¯•æ•°æ®

### ç¤ºä¾‹ Swagger æ–‡æ¡£

`test/fixtures/sample-swagger.json` åŒ…å«ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ API æ–‡æ¡£ï¼ŒåŒ…æ‹¬ï¼š

- **ç”¨æˆ·ç®¡ç†æ¨¡å—** (`user` tag)
  - è·å–ç”¨æˆ·åˆ—è¡¨ (`GET /users`)
  - åˆ›å»ºç”¨æˆ· (`POST /users`)
  - è·å–ç”¨æˆ·è¯¦æƒ… (`GET /users/{id}`)
  - æ›´æ–°ç”¨æˆ· (`PUT /users/{id}`)
  - åˆ é™¤ç”¨æˆ· (`DELETE /users/{id}`)

- **äº§å“ç®¡ç†æ¨¡å—** (`product` tag)
  - è·å–äº§å“åˆ—è¡¨ (`GET /products`)
  - åˆ›å»ºäº§å“ (`POST /products`)

- **è®¢å•ç®¡ç†æ¨¡å—** (`order` tag)
  - è·å–è®¢å•åˆ—è¡¨ (`GET /orders`)
  - åˆ›å»ºè®¢å• (`POST /orders`)

## ğŸ”§ è‡ªå®šä¹‰æµ‹è¯•

### æ·»åŠ æ–°çš„æµ‹è¯•é…ç½®

1. åœ¨ `test/configs/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„é…ç½®æ–‡ä»¶
2. åœ¨ `test/run-tests.js` ä¸­çš„ `testConfigs` æ•°ç»„æ·»åŠ æ–°é…ç½®
3. è¿è¡Œæµ‹è¯•éªŒè¯

### ä¿®æ”¹æµ‹è¯•æ•°æ®

ç¼–è¾‘ `test/fixtures/sample-swagger.json` æ¥æµ‹è¯•ä¸åŒçš„ API ç»“æ„ã€‚

### åˆ›å»ºè‡ªå®šä¹‰æµ‹è¯•è„šæœ¬

å‚è€ƒç°æœ‰è„šæœ¬åˆ›å»ºé’ˆå¯¹ç‰¹å®šåŠŸèƒ½çš„æµ‹è¯•ã€‚

## ğŸ“Š æµ‹è¯•è¾“å‡º

æµ‹è¯•æˆåŠŸåï¼Œä½ ä¼šåœ¨å¯¹åº”çš„è¾“å‡ºç›®å½•çœ‹åˆ°ï¼š

```
output/
â”œâ”€â”€ ts-api/
â”‚   â”œâ”€â”€ types.ts           # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ user/              # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts       # API å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ README.md      # æ¨¡å—æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ api-docs.json  # API æ–‡æ¡£ JSON
â”‚   â”œâ”€â”€ product/           # äº§å“æ¨¡å—
â”‚   â””â”€â”€ order/             # è®¢å•æ¨¡å—
â””â”€â”€ api-update-log.md      # æ›´æ–°æ—¥å¿—
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æƒé™é”™è¯¯**
   ```bash
   chmod +x test/*.js
   ```

2. **æ¨¡å—æ‰¾ä¸åˆ°**
   ```bash
   npm install
   ```

3. **é…ç½®æ–‡ä»¶é”™è¯¯**
   - æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
   - ç¡®ä¿è·¯å¾„æ­£ç¡®

4. **è¾“å‡ºç›®å½•é—®é¢˜**
   ```bash
   node test/cleanup.js
   ```

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹è¯¦ç»†è¾“å‡º**
   - æµ‹è¯•è„šæœ¬ä¼šæ˜¾ç¤ºå‘½ä»¤è¾“å‡º
   - æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶å†…å®¹

2. **å•ç‹¬æµ‹è¯•é…ç½®**
   ```bash
   node bin/swigger2api.js generate --config test/configs/test.config.ts --force
   ```

3. **æ£€æŸ¥æ—¥å¿—**
   - æŸ¥çœ‹ `api-update-log.md`
   - æ£€æŸ¥æ§åˆ¶å°è¾“å‡º

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ä¿®æ”¹ä»£ç åç«‹å³æµ‹è¯•**
   ```bash
   node test/quick-test.js
   ```

2. **å‘å¸ƒå‰è¿è¡Œå®Œæ•´æµ‹è¯•**
   ```bash
   node test/run-tests.js
   ```

3. **å®šæœŸæ¸…ç†æµ‹è¯•æ–‡ä»¶**
   ```bash
   node test/cleanup.js
   ```

4. **ä¿æŒæµ‹è¯•æ•°æ®æ›´æ–°**
   - æ ¹æ®æ–°åŠŸèƒ½æ›´æ–°ç¤ºä¾‹ Swagger æ–‡æ¡£
   - æ·»åŠ è¾¹ç•Œæƒ…å†µæµ‹è¯•

## ğŸ”„ æŒç»­é›†æˆ

å¯ä»¥å°†è¿™äº›æµ‹è¯•è„šæœ¬é›†æˆåˆ° CI/CD æµç¨‹ä¸­ï¼š

```json
{
  "scripts": {
    "test": "node test/run-tests.js",
    "test:quick": "node test/quick-test.js",
    "test:clean": "node test/cleanup.js",
    "pretest": "npm run test:clean"
  }
}
```

è¿™æ ·å°±å¯ä»¥åœ¨æ¯æ¬¡æäº¤æˆ–å‘å¸ƒå‰è‡ªåŠ¨è¿è¡Œæµ‹è¯•ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚